<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gurukul - Online Learning Platform</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">Gurukul</div>
                <ul class="nav-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#courses">Courses</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li><a href="checkout.html" style="color: var(--primary-color); font-weight: bold;">üõí Cart</a></li>
                    <li id="authLink"></li>
                </ul>
                <button class="hamburger" id="hamburger">‚ò∞</button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Learn From The Best</h1>
            <p>Upskill yourself with industry-relevant courses taught by experts</p>
            <button class="btn btn-primary">Explore Courses</button>
        </div>
    </section>

    <!-- Courses Section -->
    <section class="courses-section" id="courses">
        <div class="container">
            <h2>All Programs</h2>
            
            <!-- Category Filter -->
            <div class="filter-section">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="ai-ml">AI & ML</button>
                <button class="filter-btn" data-filter="web-development">Web Development</button>
                <button class="filter-btn" data-filter="data-science">Data Science</button>
                <button class="filter-btn" data-filter="cloud">Cloud & DevOps</button>
                <button class="filter-btn" data-filter="music-creative">üéµ Music & Creative</button>
                <button class="filter-btn" data-filter="social-humanities">üèõÔ∏è Social Sciences</button>
                <button class="filter-btn" data-filter="pure-sciences">üî¨ Pure Sciences</button>
                <button class="filter-btn" data-filter="mathematics-logic">üìê Mathematics</button>
                <button class="filter-btn" data-filter="liberal-arts">‚úçÔ∏è Liberal Arts</button>
            </div>

            <!-- Courses Grid -->
            <div class="courses-grid" id="coursesGrid">
                <!-- Courses will be populated by JavaScript -->
            </div>

            <div style="text-align: center; margin-top: 3rem;">
                <a href="checkout.html" class="btn btn-primary" style="text-decoration: none;">View Cart</a>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="about-section" id="about">
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>Why Choose Gurukul?</h2>
                    <ul class="about-list">
                        <li>‚úì Expert instructors with industry experience</li>
                        <li>‚úì Live classes and interactive sessions</li>
                        <li>‚úì Lifetime access to course materials</li>
                        <li>‚úì Career support and job assistance</li>
                        <li>‚úì Affordable pricing with payment plans</li>
                        <li>‚úì Certificate upon completion</li>
                    </ul>
                </div>
                <div class="about-stats">
                    <div class="stat">
                        <h3>50K+</h3>
                        <p>Students Enrolled</p>
                    </div>
                    <div class="stat">
                        <h3>100+</h3>
                        <p>Courses Available</p>
                    </div>
                    <div class="stat">
                        <h3>4.8/5</h3>
                        <p>Average Rating</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Newsletter Section -->
    <section class="newsletter-section">
        <div class="container">
            <h2>Subscribe to Our Newsletter</h2>
            <p>Get updates on new courses and learning opportunities</p>
            <form class="newsletter-form" id="newsletterForm">
                <input type="email" placeholder="Enter your email" required>
                <button type="submit" class="btn btn-primary">Subscribe</button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer" id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>About Gurukul</h3>
                    <p>We provide high-quality online education to help you advance your career in technology and innovation.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#courses">Courses</a></li>
                        <li><a href="#about">About Us</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Follow Us</h3>
                    <div class="social-links">
                        <a href="#">Instagram</a>
                        <a href="#">LinkedIn</a>
                        <a href="#">YouTube</a>
                        <a href="#">Twitter</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <p>Email: info@gurukul.com</p>
                    <p>Phone: +91 XXX XXX XXXX</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Gurukul. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Course Modal -->
    <div class="modal" id="courseModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitle"></h2>
            <p id="modalDescription"></p>
            <div class="modal-details">
                <p><strong>Duration:</strong> <span id="modalDuration"></span></p>
                <p><strong>Students Enrolled:</strong> <span id="modalStudents"></span></p>
                <p><strong>Price:</strong> <span id="modalPrice"></span></p>
            </div>
            <button class="btn btn-primary" id="enrollBtn">Enroll Now</button>
        </div>
    </div>

    <script src="script-api.js"></script>
    <script>
        // Helper functions for UI
        function getCategoryLabel(category) {
            const labelMap = {
                'web-development': 'Web Development',
                'data-science': 'Data Science',
                'cloud': 'Cloud & DevOps',
                'ai-ml': 'AI & ML',
                'music-creative': 'üéµ Music & Creative',
                'social-humanities': 'üèõÔ∏è Social Sciences',
                'pure-sciences': 'üî¨ Pure Sciences',
                'mathematics-logic': 'üìê Mathematics',
                'liberal-arts': '‚úçÔ∏è Liberal Arts'
            };
            return labelMap[category] || 'Course';
        }

        function createCourseCard(course) {
            const card = document.createElement('div');
            card.className = 'course-card';
            card.style.cursor = 'pointer';
            card.innerHTML = `
                <div class="course-image" style="background-image: url('${course.image}'); background-size: cover; background-position: center;"></div>
                <div class="course-content">
                    <span class="course-badge">${getCategoryLabel(course.category)}</span>
                    <h3>${course.title}</h3>
                    <div class="course-info">
                        <p>‚è±Ô∏è ${course.duration}</p>
                        <p>üë• ${course.students} Students Enrolled</p>
                    </div>
                    <div class="course-footer">
                        <span class="course-price">‚Çπ${typeof course.price === 'number' ? course.price.toLocaleString() : course.price}</span>
                        <button class="course-btn" onclick="event.stopPropagation(); buyNow('${course._id}')">Buy Now</button>
                    </div>
                </div>
            `;
            card.addEventListener('click', function() {
                window.location.href = `course-details.html?id=${course._id}`;
            });
            return card;
        }

        function displayCourses(coursesData, filter = 'all') {
            const coursesGrid = document.getElementById('coursesGrid');
            coursesGrid.innerHTML = '';

            const filteredCourses = filter === 'all' 
                ? coursesData 
                : coursesData.filter(course => course.category === filter);

            if (filteredCourses.length === 0) {
                coursesGrid.innerHTML = '<p style="grid-column: 1/-1; text-align: center;">No courses found</p>';
                return;
            }

            filteredCourses.forEach(course => {
                const courseCard = createCourseCard(course);
                coursesGrid.appendChild(courseCard);
            });
        }

        function buyNow(courseId) {
            if (!isUserLoggedIn()) {
                if (confirm('You need to login to purchase courses. Redirect to login?')) {
                    window.location.href = 'login.html';
                }
                return;
            }

            const course = window.allCourses.find(c => c._id === courseId);
            if (!course) return;
            
            localStorage.setItem('selectedCourse', JSON.stringify({
                id: course._id,
                title: course.title,
                price: course.price
            }));
            window.location.href = 'checkout.html';
        }

        // Setup filter buttons
        function setupFilterButtons(coursesData) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    displayCourses(coursesData, this.dataset.filter);
                });
            });
        }

        // Setup other event listeners
        function setupEventListeners() {
            const hamburger = document.getElementById('hamburger');
            const navLinks = document.querySelector('.nav-links');
            
            if (hamburger) {
                hamburger.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                });
            }

            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', function() {
                    if (navLinks) navLinks.classList.remove('active');
                });
            });

            const newsletterForm = document.getElementById('newsletterForm');
            if (newsletterForm) {
                newsletterForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('Thank you for subscribing!');
                    this.reset();
                });
            }

            document.querySelector('.close').addEventListener('click', function() {
                document.getElementById('courseModal').style.display = 'none';
            });

            window.addEventListener('click', function(e) {
                const modal = document.getElementById('courseModal');
                if (e.target == modal) {
                    modal.style.display = 'none';
                }
            });

            const exploreBtns = document.querySelectorAll('.btn-primary');
            if (exploreBtns.length > 0) {
                exploreBtns[0].addEventListener('click', function() {
                    document.getElementById('courses').scrollIntoView({ behavior: 'smooth' });
                });
            }
        }

        // Initialize on page load
        window.addEventListener('load', async () => {
            // Update navbar
            const authLink = document.getElementById('authLink');
            const currentUser = getCurrentUser();

            if (currentUser) {
                authLink.innerHTML = `
                    <a href="${currentUser.role === 'admin' ? 'admin-dashboard.html' : 'user-dashboard.html'}" 
                       style="color: var(--primary-color); font-weight: bold;">
                        üë§ ${currentUser.name}
                    </a>
                `;
            } else {
                authLink.innerHTML = `<a href="login.html" style="color: var(--primary-color); font-weight: bold;">Login</a>`;
            }

            // Fetch and display courses
            console.log('Loading courses...');
            const coursesData = await fetchCourses();
            window.allCourses = coursesData;
            displayCourses(coursesData, 'all');
            setupFilterButtons(coursesData);
            setupEventListeners();
        });
    </script>
</body>
</html>
